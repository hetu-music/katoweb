/* ============================================================================
   GLOBALS.CSS - 全局样式文件
   ============================================================================
   目录：
   1. Tailwind 配置与导入
   2. CSS 变量（设计令牌）
   3. 基础样式重置
   4. 自定义下拉组件 (Custom Select)
      4.1 基础结构
      4.2 选项状态样式
      4.3 响应式适配
      4.4 动画效果
   5. 工具类
   ============================================================================ */

/* ============================================================================
   1. TAILWIND 配置与导入
   ============================================================================ */

@import "tailwindcss";
@plugin "tailwindcss-animate";
@variant dark (&:where(.dark, .dark *));

/* ============================================================================
   2. CSS 变量（设计令牌）
   ============================================================================ */

:root {
  /* 颜色 */
  --background: #ffffff;
  --foreground: #171717;

  /* 字体系列：优先英文，后退中文 */
  --font-sans:
    var(--font-body), var(--font-body-sc), ui-sans-serif, system-ui,
    -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Arial,
    sans-serif;
  --font-serif:
    var(--font-heading), var(--font-heading-sc), ui-serif, Georgia, Cambria,
    "Times New Roman", Times, serif;
  --font-mono:
    ui-monospace, SFMono-Regular, Consolas, "Liberation Mono", Menlo, Monaco,
    "Courier New", var(--font-mono-cjk), monospace;
}

.dark {
  --background: #0a0a0a;
  --foreground: #ededed;
}

/* ============================================================================
   3. 基础样式重置
   ============================================================================ */

body {
  margin: 0;
  padding: 0;
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-sans);
  transition:
    background-color 0.3s ease-out,
    color 0.3s ease-out;
}

/* 标题样式 */
h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: var(--font-serif);
  font-weight: 700;

  /* 调整标题中数字的垂直对齐，使其与中文字符更好地对齐 */
  & > span {
    position: relative;
    top: 0.05em;
  }
}

/* 表单元素：微调输入框和按钮文字的垂直对齐（补偿 CJK 字体的垂直度量差异） */
input[type="text"],
input[type="search"],
button {
  line-height: 1.4;
}

/* ============================================================================
   4. 自定义下拉组件 (Custom Select)
   注意：视觉样式（背景、边框、圆角、阴影等）由组件的 triggerClassName 和
   optionsClassName props 通过 Tailwind 类提供，这里只定义布局和交互样式。
   ============================================================================ */

/* ----------------------------------------------------------------------------
   4.1 基础结构
   ---------------------------------------------------------------------------- */

.custom-select {
  @apply relative w-full h-12 focus:outline-none;
  touch-action: manipulation;
}

.custom-select.disabled {
  @apply opacity-50 cursor-not-allowed;
}

.custom-select-trigger {
  @apply h-full w-full cursor-pointer font-medium flex items-center justify-center;
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
}

.custom-select-trigger:active {
  transform: translateZ(0);
}

.custom-select-value {
  @apply flex-1 text-center truncate;
}

.custom-select-options {
  overflow-y: auto;
  overflow-x: hidden;
  overscroll-behavior-x: none;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
}

.custom-select-option {
  @apply px-4 py-2.5 text-center cursor-pointer w-full flex items-center justify-center;
  @apply text-slate-700 dark:text-slate-200;
  font-size: 0.875rem;
  font-weight: 500;
  line-height: 1.25rem;
  border-radius: 0.625rem;
  margin: 0.125rem 0;
  background-color: transparent;
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  touch-action: manipulation;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* ----------------------------------------------------------------------------
   4.2 选项状态样式
   ---------------------------------------------------------------------------- */

/* 选中状态 */
.custom-select-option.selected {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  color: #fff !important;
  font-weight: 600;
  box-shadow:
    0 2px 8px rgba(37, 99, 235, 0.25),
    0 0 0 1px rgba(37, 99, 235, 0.1);
  animation: selectedPulse 0.3s ease-out;
}

/* 按压状态 */
.custom-select-option:active {
  transform: scale(0.97) translateZ(0);
  transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
}

/* 焦点状态（键盘导航） */
.custom-select-option.focused {
  background-color: rgba(241, 245, 249, 0.8);
  color: #1e293b;
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
}

.dark .custom-select-option.focused {
  background-color: rgba(30, 41, 59, 0.8);
  color: #e2e8f0;
}

/* 悬停状态（仅桌面端） */
@media (hover: hover) and (pointer: fine) {
  .custom-select-option:hover:not(.selected) {
    background-color: rgba(241, 245, 249, 0.6);
    color: #1e293b;
    transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .dark .custom-select-option:hover:not(.selected) {
    background-color: rgba(30, 41, 59, 0.6);
    color: #e2e8f0;
  }

  .custom-select-option.selected:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    box-shadow:
      0 4px 12px rgba(37, 99, 235, 0.35),
      0 0 0 1px rgba(37, 99, 235, 0.15);
  }
}

/* ----------------------------------------------------------------------------
   4.3 响应式适配
   ---------------------------------------------------------------------------- */

/* --- 桌面端 (≥769px) --- */
@media (min-width: 769px) {
  .custom-select-options.desktop {
    animation: desktopDropdownFadeIn 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    transform-origin: top center;
    overflow-x: hidden;
    overscroll-behavior-x: none;
    touch-action: pan-y;
  }

  /* 滚动条样式 (Webkit) */
  .custom-select-options::-webkit-scrollbar {
    width: 6px;
  }

  .custom-select-options::-webkit-scrollbar-track {
    background: transparent;
    margin: 0.375rem 0;
  }

  .custom-select-options::-webkit-scrollbar-thumb {
    background-color: rgba(148, 163, 184, 0.3);
    border-radius: 3px;
    transition: background-color 0.2s ease;
  }

  .custom-select-options::-webkit-scrollbar-thumb:hover {
    background-color: rgba(148, 163, 184, 0.5);
  }

  .dark .custom-select-options::-webkit-scrollbar-thumb {
    background-color: rgba(71, 85, 105, 0.4);
  }

  .dark .custom-select-options::-webkit-scrollbar-thumb:hover {
    background-color: rgba(71, 85, 105, 0.6);
  }

  /* 滚动条样式 (Firefox) */
  .custom-select-options {
    scrollbar-width: thin;
    scrollbar-color: rgba(107, 114, 128, 0.4) transparent;
  }
}

/* --- 移动端 (≤768px) --- */
@media (max-width: 768px) {
  .custom-select-options.mobile {
    z-index: 51;
    max-height: 600px;
    transform-origin: center center;
    opacity: 0;
    animation: mobileDropdownFadeIn 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    animation-fill-mode: forwards;
    touch-action: pan-y;
    overflow-x: hidden;
    overscroll-behavior-x: none;
    overscroll-behavior-y: contain;
  }

  .custom-select-options.mobile.closing {
    animation: mobileDropdownFadeOut 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    animation-fill-mode: forwards;
  }

  /* 默认隐藏滚动条 */
  .custom-select-options.mobile {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .custom-select-options.mobile::-webkit-scrollbar {
    display: none;
  }

  /* 滚动时显示滚动条 */
  .custom-select-options.mobile.scrolling {
    scrollbar-width: thin;
    scrollbar-color: rgba(107, 114, 128, 0.6) transparent;
  }

  .custom-select-options.mobile.scrolling::-webkit-scrollbar {
    display: block;
    width: 3px;
  }

  .custom-select-options.mobile.scrolling::-webkit-scrollbar-track {
    background: transparent;
    margin: 16px 0;
    border-radius: 16px;
  }

  .custom-select-options.mobile.scrolling::-webkit-scrollbar-thumb {
    background-color: rgba(107, 114, 128, 0.6);
    border-radius: 2px;
    margin: 2px 0;
  }
}

/* ----------------------------------------------------------------------------
   4.4 动画效果
   ---------------------------------------------------------------------------- */

@keyframes selectedPulse {
  0% {
    transform: scale(0.98);
  }

  50% {
    transform: scale(1.01);
  }

  100% {
    transform: scale(1);
  }
}

@keyframes desktopDropdownFadeIn {
  0% {
    opacity: 0;
    transform: translateY(-8px) scale(0.96) translateZ(0);
    filter: blur(4px);
  }

  100% {
    opacity: 1;
    transform: translateY(0) scale(1) translateZ(0);
    filter: blur(0);
  }
}

@keyframes mobileDropdownFadeIn {
  0% {
    opacity: 0;
    transform: scale(0.95) translateY(-8px) translateZ(0);
    filter: blur(4px);
  }

  100% {
    opacity: 1;
    transform: scale(1) translateY(0) translateZ(0);
    filter: blur(0);
  }
}

@keyframes mobileDropdownFadeOut {
  0% {
    opacity: 1;
    transform: scale(1) translateY(0) translateZ(0);
    filter: blur(0);
  }

  100% {
    opacity: 0;
    transform: scale(0.95) translateY(-4px) translateZ(0);
    filter: blur(2px);
  }
}

/* ============================================================================
   5. 工具类
   ============================================================================ */

/* View Transitions API 自定义 */
::view-transition-old(root),
::view-transition-new(root) {
  animation: none;
  mix-blend-mode: normal;
}

/* 禁用过渡效果 */
.no-transitions,
.no-transitions *,
.no-transitions *::before,
.no-transitions *::after {
  transition: none !important;
}

/* 隐藏滚动条 */
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.no-scrollbar::-webkit-scrollbar {
  display: none;
}
